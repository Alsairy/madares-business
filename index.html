<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Madares Business - Real Estate Asset Management</title>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" 
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" 
          crossorigin=""/>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        /* Login Styles */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .login-card {
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 400px;
            text-align: center;
        }

        .login-card h1 {
            color: #B8860B;
            margin-bottom: 30px;
            font-size: 28px;
        }

        .login-card .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .login-card label {
            display: block;
            margin-bottom: 5px;
            color: #333;
            font-weight: 500;
        }

        .login-card input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .login-card input:focus {
            outline: none;
            border-color: #B8860B;
        }

        .login-card button {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #B8860B, #DAA520);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .login-card button:hover {
            transform: translateY(-2px);
        }

        .demo-credentials {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            font-size: 14px;
            color: #666;
        }

        /* Main App Styles */
        .app-container {
            display: none;
            min-height: 100vh;
            background: #f5f5f5;
        }

        .header {
            background: linear-gradient(135deg, #B8860B, #DAA520);
            color: white;
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 24px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logout-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .logout-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        .nav-tabs {
            background: white;
            padding: 0 30px;
            display: flex;
            gap: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .nav-tab {
            padding: 15px 25px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            color: #666;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }

        .nav-tab:hover {
            color: #B8860B;
            background: #f8f9fa;
        }

        .nav-tab.active {
            color: #B8860B;
            border-bottom-color: #B8860B;
            background: #f8f9fa;
        }

        .content {
            padding: 30px;
        }

        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
        }

        /* Dashboard Styles */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
        }

        .stat-number {
            font-size: 36px;
            font-weight: bold;
            color: #B8860B;
            margin-bottom: 10px;
        }

        .stat-label {
            color: #666;
            font-size: 16px;
        }

        /* Form Styles */
        .form-container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            max-width: 1200px;
            margin: 0 auto;
        }

        .form-section {
            margin-bottom: 30px;
            border: 1px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
        }

        .section-header {
            background: linear-gradient(135deg, #B8860B, #DAA520);
            color: white;
            padding: 15px 20px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 600;
            transition: background 0.3s;
        }

        .section-header:hover {
            background: linear-gradient(135deg, #A0750A, #C8941F);
        }

        .section-content {
            padding: 20px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .section-content.collapsed {
            display: none;
        }

        .field-group {
            display: flex;
            flex-direction: column;
        }

        .field-group label {
            margin-bottom: 5px;
            font-weight: 500;
            color: #333;
        }

        .field-group input,
        .field-group select,
        .field-group textarea {
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .field-group input:focus,
        .field-group select:focus,
        .field-group textarea:focus {
            outline: none;
            border-color: #B8860B;
        }

        .field-group textarea {
            resize: vertical;
            min-height: 80px;
        }

        /* Map Styles */
        .map-container {
            height: 400px;
            width: 100%;
            border: 2px solid #ddd;
            border-radius: 8px;
            margin-top: 10px;
            background: #f8f9fa;
        }

        /* File Upload Styles */
        .file-upload-area {
            border: 2px dashed #ddd;
            border-radius: 8px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: #f8f9fa;
        }

        .file-upload-area:hover {
            border-color: #B8860B;
            background: #fff;
        }

        /* Table Styles */
        .table-container {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .table-header {
            background: linear-gradient(135deg, #B8860B, #DAA520);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .table-controls {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .search-input {
            padding: 8px 12px;
            border: none;
            border-radius: 5px;
            font-size: 14px;
        }

        .filter-select {
            padding: 8px 12px;
            border: none;
            border-radius: 5px;
            font-size: 14px;
        }

        .btn-primary {
            background: #28a745;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.3s;
        }

        .btn-primary:hover {
            background: #218838;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }

        .btn-secondary:hover {
            background: #545b62;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th,
        .data-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        .data-table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #333;
        }

        .data-table tr:hover {
            background: #f8f9fa;
        }

        .btn-view,
        .btn-edit {
            padding: 6px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            margin-right: 5px;
            transition: background 0.3s;
        }

        .btn-view {
            background: #007bff;
            color: white;
        }

        .btn-view:hover {
            background: #0056b3;
        }

        .btn-edit {
            background: #ffc107;
            color: #212529;
        }

        .btn-edit:hover {
            background: #e0a800;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }

        .modal-content {
            background-color: white;
            margin: 2% auto;
            padding: 0;
            border-radius: 10px;
            width: 95%;
            max-width: 900px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            background: linear-gradient(135deg, #B8860B, #DAA520);
            color: white;
            padding: 20px;
            border-radius: 10px 10px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h2 {
            margin: 0;
            font-size: 20px;
        }

        .close {
            color: white;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            line-height: 1;
        }

        .close:hover {
            opacity: 0.7;
        }

        .modal-body {
            padding: 20px;
        }

        /* Status badges */
        .status-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }

        .status-active {
            background: #d4edda;
            color: #155724;
        }

        .status-pending {
            background: #fff3cd;
            color: #856404;
        }

        .status-inactive {
            background: #f8d7da;
            color: #721c24;
        }

        .toggle-icon {
            transition: transform 0.3s;
        }

        .toggle-icon.rotated {
            transform: rotate(90deg);
        }
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div id="loginScreen" class="login-container">
        <div class="login-card">
            <h1>🏢 Madares Business</h1>
            <p style="margin-bottom: 30px; color: #666;">Real Estate Asset Management System</p>
            
            <form id="loginForm">
                <div class="form-group">
                    <label for="username">Username</label>
                    <input type="text" id="username" name="username" value="admin" required>
                </div>
                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" name="password" required>
                </div>
                <button type="submit">Sign In</button>
            </form>
            
            <div class="demo-credentials">
                <strong>Demo Credentials:</strong><br>
                Username: admin<br>
                Password: password123
            </div>
        </div>
    </div>

    <!-- Main Application -->
    <div id="mainApp" class="app-container">
        <header class="header">
            <h1>🏢 Madares Business - Asset Management</h1>
            <div class="user-info">
                <span>Welcome, System Administrator</span>
                <button class="logout-btn" onclick="logout()">Logout</button>
            </div>
        </header>

        <nav class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('dashboard')">📊 Dashboard</button>
            <button class="nav-tab" onclick="showTab('assets')">🏢 Assets</button>
            <button class="nav-tab" onclick="showTab('add-asset')">➕ Add Asset</button>
            <button class="nav-tab" onclick="showTab('workflows')">🔄 Workflows</button>
            <button class="nav-tab" onclick="showTab('users')">👥 Users</button>
            <button class="nav-tab" onclick="showTab('reports')">📊 Reports</button>
        </nav>

        <!-- Content Area -->
        <main class="content">
            <!-- Dashboard Section -->
            <section id="dashboard" class="content-section active">
                <div class="dashboard-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="totalAssets">3</div>
                        <div class="stat-label">Total Assets</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="activeWorkflows">2</div>
                        <div class="stat-label">Active Workflows</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="regionsCovered">3</div>
                        <div class="stat-label">Regions Covered</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="totalUsers">3</div>
                        <div class="stat-label">Total Users</div>
                    </div>
                </div>

                <div class="table-container">
                    <div class="table-header">
                        <h2>📈 Recent Activities</h2>
                    </div>
                    <div style="padding: 20px;">
                        <div style="margin-bottom: 10px;">🏢 Asset AST-001 registered in Riyadh region (2 hours ago)</div>
                        <div style="margin-bottom: 10px;">🔄 Workflow WF-003 completed for Dammam property (4 hours ago)</div>
                        <div style="margin-bottom: 10px;">👥 New user ahmed.rashid added to system (1 day ago)</div>
                        <div style="margin-bottom: 10px;">📊 Investment analysis report generated (2 days ago)</div>
                    </div>
                </div>
            </section>

            <!-- Assets Section -->
            <section id="assets" class="content-section">
                <div class="table-container">
                    <div class="table-header">
                        <h2>🏢 Asset Management</h2>
                        <div class="table-controls">
                            <input type="text" class="search-input" placeholder="Search assets..." id="assetSearch">
                            <select class="filter-select" id="regionFilter">
                                <option value="">All Regions</option>
                                <option value="Riyadh">Riyadh</option>
                                <option value="Makkah">Makkah</option>
                                <option value="Eastern Province">Eastern Province</option>
                            </select>
                        </div>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Asset ID</th>
                                <th>Building Name</th>
                                <th>Region</th>
                                <th>City</th>
                                <th>Condition</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="assetsTableBody">
                            <tr>
                                <td>AST-001</td>
                                <td>Riyadh Educational Complex</td>
                                <td>Riyadh</td>
                                <td>Riyadh</td>
                                <td><span class="status-badge status-active">Good</span></td>
                                <td><span class="status-badge status-active">Active</span></td>
                                <td>
                                    <button class="btn-view" onclick="viewAsset('AST-001')">View</button>
                                    <button class="btn-edit" onclick="editAsset('AST-001')">Edit</button>
                                </td>
                            </tr>
                            <tr>
                                <td>AST-002</td>
                                <td>Jeddah Training Center</td>
                                <td>Makkah</td>
                                <td>Jeddah</td>
                                <td><span class="status-badge status-active">Excellent</span></td>
                                <td><span class="status-badge status-active">Active</span></td>
                                <td>
                                    <button class="btn-view" onclick="viewAsset('AST-002')">View</button>
                                    <button class="btn-edit" onclick="editAsset('AST-002')">Edit</button>
                                </td>
                            </tr>
                            <tr>
                                <td>AST-003</td>
                                <td>Dammam Business Hub</td>
                                <td>Eastern Province</td>
                                <td>Dammam</td>
                                <td><span class="status-badge status-pending">Fair</span></td>
                                <td><span class="status-badge status-pending">Under Review</span></td>
                                <td>
                                    <button class="btn-view" onclick="viewAsset('AST-003')">View</button>
                                    <button class="btn-edit" onclick="editAsset('AST-003')">Edit</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Add Asset Section -->
            <section id="add-asset" class="content-section">
                <div class="form-container">
                    <h2 style="margin-bottom: 30px; color: #B8860B;">⭐ Add New Asset - Complete MOE Form</h2>
                    
                    <form id="assetForm">
                        <!-- 1. Asset Identification & Status -->
                        <div class="form-section">
                            <div class="section-header" onclick="toggleSection(this)">
                                <span>🏢 Asset Identification & Status</span>
                                <span class="toggle-icon">▼</span>
                            </div>
                            <div class="section-content">
                                <div class="field-group">
                                    <label for="assetId">Asset ID *</label>
                                    <input type="text" id="assetId" name="assetId" value="AST-004" readonly>
                                </div>
                                <div class="field-group">
                                    <label for="buildingName">Building Name *</label>
                                    <input type="text" id="buildingName" name="buildingName" required>
                                </div>
                                <div class="field-group">
                                    <label for="assetCondition">Asset Condition</label>
                                    <select id="assetCondition" name="assetCondition">
                                        <option value="Excellent">Excellent</option>
                                        <option value="Good" selected>Good</option>
                                        <option value="Fair">Fair</option>
                                        <option value="Poor">Poor</option>
                                    </select>
                                </div>
                                <div class="field-group">
                                    <label for="assetStatus">Asset Status</label>
                                    <select id="assetStatus" name="assetStatus">
                                        <option value="Active" selected>Active</option>
                                        <option value="Under Review">Under Review</option>
                                        <option value="Inactive">Inactive</option>
                                        <option value="Planned">Planned</option>
                                    </select>
                                </div>
                                <div class="field-group">
                                    <label for="decisionNumber">Decision Number</label>
                                    <input type="text" id="decisionNumber" name="decisionNumber">
                                </div>
                            </div>
                        </div>

                        <!-- 2. Planning & Need Assessment -->
                        <div class="form-section">
                            <div class="section-header" onclick="toggleSection(this)">
                                <span>📋 Planning & Need Assessment</span>
                                <span class="toggle-icon">▼</span>
                            </div>
                            <div class="section-content">
                                <div class="field-group">
                                    <label for="planningNeed">Planning Need</label>
                                    <textarea id="planningNeed" name="planningNeed" placeholder="Describe the planning need for this asset..."></textarea>
                                </div>
                                <div class="field-group">
                                    <label for="expectedDuration">Expected Duration (months)</label>
                                    <input type="number" id="expectedDuration" name="expectedDuration">
                                </div>
                                <div class="field-group">
                                    <label for="previousAppNumber">Previous Application Number</label>
                                    <input type="text" id="previousAppNumber" name="previousAppNumber">
                                </div>
                                <div class="field-group">
                                    <label for="previousAppDate">Previous Application Date</label>
                                    <input type="date" id="previousAppDate" name="previousAppDate">
                                </div>
                            </div>
                        </div>

                        <!-- 3. Location Attractiveness -->
                        <div class="form-section">
                            <div class="section-header" onclick="toggleSection(this)">
                                <span>📍 Location Attractiveness</span>
                                <span class="toggle-icon">▼</span>
                            </div>
                            <div class="section-content">
                                <div class="field-group">
                                    <label for="cityLocationDesires">City/Location within Investors' Desires</label>
                                    <select id="cityLocationDesires" name="cityLocationDesires">
                                        <option value="High">High</option>
                                        <option value="Medium" selected>Medium</option>
                                        <option value="Low">Low</option>
                                    </select>
                                </div>
                                <div class="field-group">
                                    <label for="criticalAreas">Critical Areas</label>
                                    <input type="text" id="criticalAreas" name="criticalAreas" placeholder="e.g., Commercial, Educational, Residential">
                                </div>
                                <div class="field-group">
                                    <label for="locationNotes">Location Attractiveness Notes</label>
                                    <textarea id="locationNotes" name="locationNotes" placeholder="Additional notes about location attractiveness..."></textarea>
                                </div>
                            </div>
                        </div>

                        <!-- 4. Investment Proposal & Obstacles -->
                        <div class="form-section">
                            <div class="section-header" onclick="toggleSection(this)">
                                <span>💰 Investment Proposal & Obstacles</span>
                                <span class="toggle-icon">▼</span>
                            </div>
                            <div class="section-content">
                                <div class="field-group">
                                    <label for="investmentProposal">Investment Proposal</label>
                                    <textarea id="investmentProposal" name="investmentProposal" placeholder="Describe the investment proposal..."></textarea>
                                </div>
                                <div class="field-group">
                                    <label for="investmentObstacles">Investment Obstacles</label>
                                    <textarea id="investmentObstacles" name="investmentObstacles" placeholder="List any obstacles to investment..."></textarea>
                                </div>
                                <div class="field-group">
                                    <label for="estimatedValue">Estimated Value (SAR)</label>
                                    <input type="number" id="estimatedValue" name="estimatedValue" step="0.01">
                                </div>
                            </div>
                        </div>

                        <!-- 5. Financial Obligations & Covenants -->
                        <div class="form-section">
                            <div class="section-header" onclick="toggleSection(this)">
                                <span>💳 Financial Obligations & Covenants</span>
                                <span class="toggle-icon">▼</span>
                            </div>
                            <div class="section-content">
                                <div class="field-group">
                                    <label for="financialObligations">Financial Obligations</label>
                                    <textarea id="financialObligations" name="financialObligations" placeholder="Describe financial obligations..."></textarea>
                                </div>
                                <div class="field-group">
                                    <label for="covenants">Covenants</label>
                                    <textarea id="covenants" name="covenants" placeholder="List any covenants..."></textarea>
                                </div>
                                <div class="field-group">
                                    <label for="annualCost">Annual Cost (SAR)</label>
                                    <input type="number" id="annualCost" name="annualCost" step="0.01">
                                </div>
                            </div>
                        </div>

                        <!-- 6. Utilities Information -->
                        <div class="form-section">
                            <div class="section-header" onclick="toggleSection(this)">
                                <span>⚡ Utilities Information</span>
                                <span class="toggle-icon">▼</span>
                            </div>
                            <div class="section-content">
                                <div class="field-group">
                                    <label for="electricityAvailable">Electricity Available</label>
                                    <select id="electricityAvailable" name="electricityAvailable">
                                        <option value="Yes" selected>Yes</option>
                                        <option value="No">No</option>
                                        <option value="Partial">Partial</option>
                                    </select>
                                </div>
                                <div class="field-group">
                                    <label for="waterAvailable">Water Available</label>
                                    <select id="waterAvailable" name="waterAvailable">
                                        <option value="Yes" selected>Yes</option>
                                        <option value="No">No</option>
                                        <option value="Partial">Partial</option>
                                    </select>
                                </div>
                                <div class="field-group">
                                    <label for="sewerageAvailable">Sewerage Available</label>
                                    <select id="sewerageAvailable" name="sewerageAvailable">
                                        <option value="Yes" selected>Yes</option>
                                        <option value="No">No</option>
                                        <option value="Partial">Partial</option>
                                    </select>
                                </div>
                                <div class="field-group">
                                    <label for="internetAvailable">Internet Available</label>
                                    <select id="internetAvailable" name="internetAvailable">
                                        <option value="Yes" selected>Yes</option>
                                        <option value="No">No</option>
                                        <option value="Partial">Partial</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- 7. Ownership Information -->
                        <div class="form-section">
                            <div class="section-header" onclick="toggleSection(this)">
                                <span>📋 Ownership Information</span>
                                <span class="toggle-icon">▼</span>
                            </div>
                            <div class="section-content">
                                <div class="field-group">
                                    <label for="ownershipType">Ownership Type</label>
                                    <select id="ownershipType" name="ownershipType">
                                        <option value="Government">Government</option>
                                        <option value="Private">Private</option>
                                        <option value="Mixed">Mixed</option>
                                        <option value="Leased">Leased</option>
                                    </select>
                                </div>
                                <div class="field-group">
                                    <label for="ownerName">Owner Name</label>
                                    <input type="text" id="ownerName" name="ownerName">
                                </div>
                                <div class="field-group">
                                    <label for="ownerContact">Owner Contact</label>
                                    <input type="text" id="ownerContact" name="ownerContact">
                                </div>
                                <div class="field-group">
                                    <label for="deedNumber">Deed Number</label>
                                    <input type="text" id="deedNumber" name="deedNumber">
                                </div>
                            </div>
                        </div>

                        <!-- 8. Land & Plan Details -->
                        <div class="form-section">
                            <div class="section-header" onclick="toggleSection(this)">
                                <span>🗺️ Land & Plan Details</span>
                                <span class="toggle-icon">▼</span>
                            </div>
                            <div class="section-content">
                                <div class="field-group">
                                    <label for="landArea">Land Area (m²)</label>
                                    <input type="number" id="landArea" name="landArea" step="0.01">
                                </div>
                                <div class="field-group">
                                    <label for="planNumber">Plan Number</label>
                                    <input type="text" id="planNumber" name="planNumber">
                                </div>
                                <div class="field-group">
                                    <label for="plotNumber">Plot Number</label>
                                    <input type="text" id="plotNumber" name="plotNumber">
                                </div>
                            </div>
                        </div>

                        <!-- 9. Asset Area Details -->
                        <div class="form-section">
                            <div class="section-header" onclick="toggleSection(this)">
                                <span>📐 Asset Area Details</span>
                                <span class="toggle-icon">▼</span>
                            </div>
                            <div class="section-content">
                                <div class="field-group">
                                    <label for="builtUpArea">Built-up Area (m²)</label>
                                    <input type="number" id="builtUpArea" name="builtUpArea" step="0.01">
                                </div>
                                <div class="field-group">
                                    <label for="usableArea">Usable Area (m²)</label>
                                    <input type="number" id="usableArea" name="usableArea" step="0.01">
                                </div>
                                <div class="field-group">
                                    <label for="floors">Number of Floors</label>
                                    <input type="number" id="floors" name="floors">
                                </div>
                                <div class="field-group">
                                    <label for="rooms">Number of Rooms</label>
                                    <input type="number" id="rooms" name="rooms">
                                </div>
                                <div class="field-group">
                                    <label for="parkingSpaces">Parking Spaces</label>
                                    <input type="number" id="parkingSpaces" name="parkingSpaces">
                                </div>
                            </div>
                        </div>

                        <!-- 10. Construction Status -->
                        <div class="form-section">
                            <div class="section-header" onclick="toggleSection(this)">
                                <span>🏗️ Construction Status</span>
                                <span class="toggle-icon">▼</span>
                            </div>
                            <div class="section-content">
                                <div class="field-group">
                                    <label for="constructionStatus">Construction Status</label>
                                    <select id="constructionStatus" name="constructionStatus">
                                        <option value="Completed">Completed</option>
                                        <option value="Under Construction">Under Construction</option>
                                        <option value="Planned">Planned</option>
                                        <option value="On Hold">On Hold</option>
                                        <option value="Demolished">Demolished</option>
                                    </select>
                                </div>
                                <div class="field-group">
                                    <label for="constructionYear">Construction Year</label>
                                    <input type="number" id="constructionYear" name="constructionYear" min="1900" max="2030">
                                </div>
                                <div class="field-group">
                                    <label for="renovationYear">Last Renovation Year</label>
                                    <input type="number" id="renovationYear" name="renovationYear" min="1900" max="2030">
                                </div>
                                <div class="field-group">
                                    <label for="constructionCompany">Construction Company</label>
                                    <input type="text" id="constructionCompany" name="constructionCompany">
                                </div>
                            </div>
                        </div>

                        <!-- 11. Physical Dimensions -->
                        <div class="form-section">
                            <div class="section-header" onclick="toggleSection(this)">
                                <span>📏 Physical Dimensions</span>
                                <span class="toggle-icon">▼</span>
                            </div>
                            <div class="section-content">
                                <div class="field-group">
                                    <label for="northDimension">North Dimension (meters)</label>
                                    <input type="number" id="northDimension" name="northDimension" step="0.01">
                                </div>
                                <div class="field-group">
                                    <label for="eastDimension">East Dimension (meters)</label>
                                    <input type="number" id="eastDimension" name="eastDimension" step="0.01">
                                </div>
                                <div class="field-group">
                                    <label for="southDimension">South Dimension (meters)</label>
                                    <input type="number" id="southDimension" name="southDimension" step="0.01">
                                </div>
                                <div class="field-group">
                                    <label for="westDimension">West Dimension (meters)</label>
                                    <input type="number" id="westDimension" name="westDimension" step="0.01">
                                </div>
                            </div>
                        </div>

                        <!-- 12. Boundaries -->
                        <div class="form-section">
                            <div class="section-header" onclick="toggleSection(this)">
                                <span>🧭 Boundaries</span>
                                <span class="toggle-icon">▼</span>
                            </div>
                            <div class="section-content">
                                <div class="field-group">
                                    <label for="northBoundaryDesc">North Boundary Description</label>
                                    <input type="text" id="northBoundaryDesc" name="northBoundaryDesc" placeholder="e.g., Main Street">
                                </div>
                                <div class="field-group">
                                    <label for="northBoundaryType">North Boundary Type</label>
                                    <select id="northBoundaryType" name="northBoundaryType">
                                        <option value="Street" selected>Street</option>
                                        <option value="Adjacent Property">Adjacent Property</option>
                                        <option value="Natural Feature">Natural Feature</option>
                                        <option value="Fence/Wall">Fence/Wall</option>
                                    </select>
                                </div>
                                <div class="field-group">
                                    <label for="eastBoundaryDesc">East Boundary Description</label>
                                    <input type="text" id="eastBoundaryDesc" name="eastBoundaryDesc">
                                </div>
                                <div class="field-group">
                                    <label for="eastBoundaryType">East Boundary Type</label>
                                    <select id="eastBoundaryType" name="eastBoundaryType">
                                        <option value="Street" selected>Street</option>
                                        <option value="Adjacent Property">Adjacent Property</option>
                                        <option value="Natural Feature">Natural Feature</option>
                                        <option value="Fence/Wall">Fence/Wall</option>
                                    </select>
                                </div>
                                <div class="field-group">
                                    <label for="southBoundaryDesc">South Boundary Description</label>
                                    <input type="text" id="southBoundaryDesc" name="southBoundaryDesc">
                                </div>
                                <div class="field-group">
                                    <label for="southBoundaryType">South Boundary Type</label>
                                    <select id="southBoundaryType" name="southBoundaryType">
                                        <option value="Street" selected>Street</option>
                                        <option value="Adjacent Property">Adjacent Property</option>
                                        <option value="Natural Feature">Natural Feature</option>
                                        <option value="Fence/Wall">Fence/Wall</option>
                                    </select>
                                </div>
                                <div class="field-group">
                                    <label for="westBoundaryDesc">West Boundary Description</label>
                                    <input type="text" id="westBoundaryDesc" name="westBoundaryDesc">
                                </div>
                                <div class="field-group">
                                    <label for="westBoundaryType">West Boundary Type</label>
                                    <select id="westBoundaryType" name="westBoundaryType">
                                        <option value="Street" selected>Street</option>
                                        <option value="Adjacent Property">Adjacent Property</option>
                                        <option value="Natural Feature">Natural Feature</option>
                                        <option value="Fence/Wall">Fence/Wall</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- 13. Geographic Location -->
                        <div class="form-section">
                            <div class="section-header" onclick="toggleSection(this)">
                                <span>📍 Geographic Location</span>
                                <span class="toggle-icon">▼</span>
                            </div>
                            <div class="section-content">
                                <div class="field-group">
                                    <label for="region">Region *</label>
                                    <select id="region" name="region" required>
                                        <option value="Riyadh" selected>Riyadh</option>
                                        <option value="Makkah">Makkah</option>
                                        <option value="Eastern Province">Eastern Province</option>
                                        <option value="Madinah">Madinah</option>
                                        <option value="Asir">Asir</option>
                                        <option value="Northern Borders">Northern Borders</option>
                                        <option value="Jazan">Jazan</option>
                                        <option value="Najran">Najran</option>
                                        <option value="Al Bahah">Al Bahah</option>
                                        <option value="Tabuk">Tabuk</option>
                                        <option value="Hail">Hail</option>
                                        <option value="Al Qassim">Al Qassim</option>
                                        <option value="Al Jouf">Al Jouf</option>
                                    </select>
                                </div>
                                <div class="field-group">
                                    <label for="city">City *</label>
                                    <input type="text" id="city" name="city" required>
                                </div>
                                <div class="field-group">
                                    <label for="district">District</label>
                                    <input type="text" id="district" name="district">
                                </div>
                                <div class="field-group">
                                    <label for="neighborhood">Neighborhood</label>
                                    <input type="text" id="neighborhood" name="neighborhood">
                                </div>
                                <div class="field-group">
                                    <label for="latitude">Latitude</label>
                                    <input type="text" id="latitude" name="latitude" placeholder="Click on map to select" readonly>
                                </div>
                                <div class="field-group">
                                    <label for="longitude">Longitude</label>
                                    <input type="text" id="longitude" name="longitude" placeholder="Click on map to select" readonly>
                                </div>
                                <div class="field-group" style="grid-column: 1 / -1;">
                                    <label>📍 Click on the map to select coordinates:</label>
                                    <div id="map" class="map-container"></div>
                                </div>
                                <div class="field-group">
                                    <label for="address">Full Address</label>
                                    <textarea id="address" name="address" placeholder="Enter complete address..."></textarea>
                                </div>
                            </div>
                        </div>

                        <!-- 14. Supporting Documents -->
                        <div class="form-section">
                            <div class="section-header" onclick="toggleSection(this)">
                                <span>📁 Supporting Documents</span>
                                <span class="toggle-icon">▼</span>
                            </div>
                            <div class="section-content">
                                <div class="field-group">
                                    <label>Property Deed</label>
                                    <div class="file-upload-area" onclick="document.getElementById('propertyDeed').click()">
                                        <p>📄 Click to upload or drag and drop</p>
                                        <p style="font-size: 12px; color: #666;">PDF, DOC, JPG, PNG (Max 10MB)</p>
                                    </div>
                                    <input type="file" id="propertyDeed" name="propertyDeed" style="display: none;" accept=".pdf,.doc,.docx,.jpg,.jpeg,.png" multiple>
                                </div>
                                <div class="field-group">
                                    <label>Survey Report</label>
                                    <div class="file-upload-area" onclick="document.getElementById('surveyReport').click()">
                                        <p>📊 Click to upload or drag and drop</p>
                                        <p style="font-size: 12px; color: #666;">PDF, DOC, JPG, PNG (Max 10MB)</p>
                                    </div>
                                    <input type="file" id="surveyReport" name="surveyReport" style="display: none;" accept=".pdf,.doc,.docx,.jpg,.jpeg,.png" multiple>
                                </div>
                                <div class="field-group">
                                    <label>Investment Proposal</label>
                                    <div class="file-upload-area" onclick="document.getElementById('investmentProposal').click()">
                                        <p>💰 Click to upload or drag and drop</p>
                                        <p style="font-size: 12px; color: #666;">PDF, DOC, XLS, XLSX (Max 10MB)</p>
                                    </div>
                                    <input type="file" id="investmentProposal" name="investmentProposal" style="display: none;" accept=".pdf,.doc,.docx,.xls,.xlsx" multiple>
                                </div>
                                <div class="field-group">
                                    <label>Financial Documents</label>
                                    <div class="file-upload-area" onclick="document.getElementById('financialDocs').click()">
                                        <p>💳 Click to upload or drag and drop</p>
                                        <p style="font-size: 12px; color: #666;">PDF, DOC, XLS, XLSX (Max 10MB)</p>
                                    </div>
                                    <input type="file" id="financialDocs" name="financialDocs" style="display: none;" accept=".pdf,.doc,.docx,.xls,.xlsx" multiple>
                                </div>
                                <div class="field-group">
                                    <label>Engineering Reports</label>
                                    <div class="file-upload-area" onclick="document.getElementById('engineeringReports').click()">
                                        <p>🏗️ Click to upload or drag and drop</p>
                                        <p style="font-size: 12px; color: #666;">PDF, DOC, JPG, PNG (Max 10MB)</p>
                                    </div>
                                    <input type="file" id="engineeringReports" name="engineeringReports" style="display: none;" accept=".pdf,.doc,.docx,.jpg,.jpeg,.png" multiple>
                                </div>
                                <div class="field-group">
                                    <label>Other Documents</label>
                                    <div class="file-upload-area" onclick="document.getElementById('otherDocs').click()">
                                        <p>📋 Click to upload or drag and drop</p>
                                        <p style="font-size: 12px; color: #666;">PDF, DOC, JPG, PNG (Max 10MB)</p>
                                    </div>
                                    <input type="file" id="otherDocs" name="otherDocs" style="display: none;" accept=".pdf,.doc,.docx,.jpg,.jpeg,.png" multiple>
                                </div>
                            </div>
                        </div>

                        <!-- Form Actions -->
                        <div style="margin-top: 30px; text-align: center;">
                            <button type="submit" class="btn-primary" style="padding: 15px 40px; font-size: 16px;">
                                💾 Submit Asset
                            </button>
                            <button type="button" class="btn-secondary" style="padding: 15px 40px; font-size: 16px; margin-left: 15px;" onclick="resetForm()">
                                🔄 Reset Form
                            </button>
                        </div>
                    </form>
                </div>
            </section>

            <!-- Workflows Section -->
            <section id="workflows" class="content-section">
                <div class="table-container">
                    <div class="table-header">
                        <h2>🔄 Workflow Management</h2>
                        <div class="table-controls">
                            <button class="btn-primary" onclick="showCreateWorkflowModal()">Create New Workflow</button>
                            <button class="btn-secondary" onclick="loadWorkflows()">Refresh</button>
                        </div>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Title</th>
                                <th>Status</th>
                                <th>Assigned To</th>
                                <th>Due Date</th>
                                <th>Priority</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="workflowsTableBody">
                            <tr>
                                <td>WF-001</td>
                                <td>Asset Registration Review</td>
                                <td><span class="status-badge status-active">In Progress</span></td>
                                <td>Ahmed Al-Rashid</td>
                                <td>2025-08-15</td>
                                <td><span class="status-badge status-inactive">High</span></td>
                                <td>
                                    <button class="btn-view" onclick="viewWorkflow('WF-001')">View</button>
                                    <button class="btn-edit" onclick="editWorkflow('WF-001')">Edit</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Users Section -->
            <section id="users" class="content-section">
                <div class="table-container">
                    <div class="table-header">
                        <h2>👥 User Management</h2>
                        <div class="table-controls">
                            <button class="btn-primary" onclick="showCreateUserModal()">Add New User</button>
                            <button class="btn-secondary" onclick="loadUsers()">Refresh</button>
                        </div>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Username</th>
                                <th>Name</th>
                                <th>Role</th>
                                <th>Department</th>
                                <th>Region</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="usersTableBody">
                            <tr>
                                <td>1</td>
                                <td>admin</td>
                                <td>System Administrator</td>
                                <td>Central Admin</td>
                                <td>IT Administration</td>
                                <td>All Regions</td>
                                <td><span class="status-badge status-active">Active</span></td>
                                <td>
                                    <button class="btn-view" onclick="viewUser('1')">View</button>
                                    <button class="btn-edit" onclick="editUser('1')">Edit</button>
                                </td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td>ahmed.rashid</td>
                                <td>Ahmed Al-Rashid</td>
                                <td>Regional Manager</td>
                                <td>Asset Management</td>
                                <td>Riyadh</td>
                                <td><span class="status-badge status-active">Active</span></td>
                                <td>
                                    <button class="btn-view" onclick="viewUser('2')">View</button>
                                    <button class="btn-edit" onclick="editUser('2')">Edit</button>
                                </td>
                            </tr>
                            <tr>
                                <td>3</td>
                                <td>fatima.zahra</td>
                                <td>Fatima Al-Zahra</td>
                                <td>Investment Analyst</td>
                                <td>Financial Planning</td>
                                <td>Makkah</td>
                                <td><span class="status-badge status-active">Active</span></td>
                                <td>
                                    <button class="btn-view" onclick="viewUser('3')">View</button>
                                    <button class="btn-edit" onclick="editUser('3')">Edit</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Reports Section -->
            <section id="reports" class="content-section">
                <div class="table-container">
                    <div class="table-header">
                        <h2>📊 Reports & Analytics</h2>
                    </div>
                    <div style="padding: 30px;">
                        <div class="dashboard-grid">
                            <div class="stat-card" style="cursor: pointer;" onclick="generateReport('asset-summary')">
                                <div style="font-size: 48px; margin-bottom: 15px;">📋</div>
                                <div style="font-size: 18px; font-weight: 600; margin-bottom: 10px;">Asset Summary Report</div>
                                <div style="color: #666;">Complete overview of all assets</div>
                            </div>
                            <div class="stat-card" style="cursor: pointer;" onclick="generateReport('regional-distribution')">
                                <div style="font-size: 48px; margin-bottom: 15px;">🗺️</div>
                                <div style="font-size: 18px; font-weight: 600; margin-bottom: 10px;">Regional Distribution</div>
                                <div style="color: #666;">Assets by region and city</div>
                            </div>
                            <div class="stat-card" style="cursor: pointer;" onclick="generateReport('construction-status')">
                                <div style="font-size: 48px; margin-bottom: 15px;">🏗️</div>
                                <div style="font-size: 18px; font-weight: 600; margin-bottom: 10px;">Construction Status</div>
                                <div style="color: #666;">Building and construction progress</div>
                            </div>
                            <div class="stat-card" style="cursor: pointer;" onclick="generateReport('investment-analysis')">
                                <div style="font-size: 48px; margin-bottom: 15px;">💰</div>
                                <div style="font-size: 18px; font-weight: 600; margin-bottom: 10px;">Investment Analysis</div>
                                <div style="color: #666;">Financial and investment insights</div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Modals -->
    <div id="assetModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="assetModalTitle">Asset Details</h2>
                <span class="close" onclick="closeModal('assetModal')">&times;</span>
            </div>
            <div class="modal-body" id="assetModalBody">
                <!-- Asset details will be populated here -->
            </div>
        </div>
    </div>

    <div id="userModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="userModalTitle">User Details</h2>
                <span class="close" onclick="closeModal('userModal')">&times;</span>
            </div>
            <div class="modal-body" id="userModalBody">
                <!-- User details will be populated here -->
            </div>
        </div>
    </div>

    <div id="workflowModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="workflowModalTitle">Workflow Details</h2>
                <span class="close" onclick="closeModal('workflowModal')">&times;</span>
            </div>
            <div class="modal-body" id="workflowModalBody">
                <!-- Workflow details will be populated here -->
            </div>
        </div>
    </div>

    <!-- Leaflet JavaScript -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" 
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" 
            crossorigin=""></script>

    <script>
        // Global variables
        let map;
        let currentMarker;

        // Sample data with complete MOE fields
        const sampleAssets = {
            'AST-001': {
                id: 'AST-001',
                buildingName: 'Riyadh Educational Complex',
                region: 'Riyadh',
                city: 'Riyadh',
                district: 'Al-Malaz',
                neighborhood: 'King Saud University',
                condition: 'Good',
                status: 'Active',
                latitude: '24.7136',
                longitude: '46.6753',
                landArea: '5000',
                builtUpArea: '3500',
                usableArea: '3200',
                floors: '3',
                rooms: '25',
                parkingSpaces: '50',
                constructionYear: '2018',
                renovationYear: '2022',
                ownershipType: 'Government',
                ownerName: 'Ministry of Education',
                estimatedValue: '15000000',
                created: '2025-01-15'
            },
            'AST-002': {
                id: 'AST-002',
                buildingName: 'Jeddah Training Center',
                region: 'Makkah',
                city: 'Jeddah',
                district: 'Al-Hamra',
                neighborhood: 'Business District',
                condition: 'Excellent',
                status: 'Active',
                latitude: '21.4858',
                longitude: '39.1925',
                landArea: '3500',
                builtUpArea: '2800',
                usableArea: '2600',
                floors: '2',
                rooms: '18',
                parkingSpaces: '35',
                constructionYear: '2020',
                renovationYear: '2023',
                ownershipType: 'Government',
                ownerName: 'Ministry of Education',
                estimatedValue: '12000000',
                created: '2025-01-10'
            },
            'AST-003': {
                id: 'AST-003',
                buildingName: 'Dammam Business Hub',
                region: 'Eastern Province',
                city: 'Dammam',
                district: 'Al-Faisaliyah',
                neighborhood: 'Commercial Center',
                condition: 'Fair',
                status: 'Under Review',
                latitude: '26.4207',
                longitude: '50.0888',
                landArea: '4200',
                builtUpArea: '3000',
                usableArea: '2800',
                floors: '4',
                rooms: '30',
                parkingSpaces: '60',
                constructionYear: '2015',
                renovationYear: '2020',
                ownershipType: 'Mixed',
                ownerName: 'Public-Private Partnership',
                estimatedValue: '18000000',
                created: '2025-01-05'
            }
        };

        const sampleUsers = {
            '1': {
                id: '1',
                username: 'admin',
                name: 'System Administrator',
                email: 'admin@madares.sa',
                role: 'Central Admin',
                department: 'IT Administration',
                region: 'All Regions',
                status: 'Active',
                lastLogin: '2025-08-04'
            },
            '2': {
                id: '2',
                username: 'ahmed.rashid',
                name: 'Ahmed Al-Rashid',
                email: 'ahmed.rashid@madares.sa',
                role: 'Regional Manager',
                department: 'Asset Management',
                region: 'Riyadh',
                status: 'Active',
                lastLogin: '2025-08-04'
            },
            '3': {
                id: '3',
                username: 'fatima.zahra',
                name: 'Fatima Al-Zahra',
                email: 'fatima.zahra@madares.sa',
                role: 'Investment Analyst',
                department: 'Financial Planning',
                region: 'Makkah',
                status: 'Active',
                lastLogin: '2025-08-04'
            }
        };

        const sampleWorkflows = {
            'WF-001': {
                id: 'WF-001',
                title: 'Asset Registration Review',
                description: 'Review and approve new asset registration for Riyadh Complex',
                status: 'In Progress',
                priority: 'High',
                assignedTo: 'Ahmed Al-Rashid',
                dueDate: '2025-08-15',
                assetId: 'AST-001',
                created: '2025-08-01'
            }
        };

        // Authentication functions
        function login(event) {
            event.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            if (username === 'admin' && password === 'password123') {
                document.getElementById('loginScreen').style.display = 'none';
                document.getElementById('mainApp').style.display = 'block';
                initializeMap();
                loadDashboardData();
            } else {
                alert('Invalid credentials. Please use admin/password123');
            }
        }

        function logout() {
            document.getElementById('loginScreen').style.display = 'flex';
            document.getElementById('mainApp').style.display = 'none';
            document.getElementById('username').value = 'admin';
            document.getElementById('password').value = '';
        }

        // Navigation functions
        function showTab(tabName) {
            // Hide all content sections
            const sections = document.querySelectorAll('.content-section');
            sections.forEach(section => section.classList.remove('active'));
            
            // Remove active class from all tabs
            const tabs = document.querySelectorAll('.nav-tab');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // Show selected section
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked tab
            event.target.classList.add('active');
            
            // Initialize map if Add Asset tab is shown
            if (tabName === 'add-asset') {
                setTimeout(() => {
                    if (map) {
                        map.invalidateSize();
                    } else {
                        initializeMap();
                    }
                }, 100);
            }
            
            // Load data for specific tabs
            if (tabName === 'users') {
                loadUsers();
            } else if (tabName === 'workflows') {
                loadWorkflows();
            } else if (tabName === 'dashboard') {
                loadDashboardData();
            }
        }

        // Map functions
        function initializeMap() {
            if (map) {
                map.remove();
            }
            
            try {
                // Initialize map centered on Saudi Arabia
                map = L.map('map').setView([24.7136, 46.6753], 6);
                
                // Add OpenStreetMap tiles
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '© OpenStreetMap contributors',
                    maxZoom: 18
                }).addTo(map);
                
                // Add click event listener
                map.on('click', function(e) {
                    const lat = e.latlng.lat.toFixed(6);
                    const lng = e.latlng.lng.toFixed(6);
                    
                    // Update form fields
                    document.getElementById('latitude').value = lat;
                    document.getElementById('longitude').value = lng;
                    
                    // Remove existing marker
                    if (currentMarker) {
                        map.removeLayer(currentMarker);
                    }
                    
                    // Add new marker
                    currentMarker = L.marker([lat, lng]).addTo(map)
                        .bindPopup(`Selected: ${lat}, ${lng}`)
                        .openPopup();
                });
                
                console.log('Map initialized successfully');
            } catch (error) {
                console.error('Error initializing map:', error);
                document.getElementById('map').innerHTML = '<div style="display: flex; align-items: center; justify-content: center; height: 100%; color: #666;">Map could not be loaded. Please check your internet connection.</div>';
            }
        }

        // Form functions
        function toggleSection(header) {
            const content = header.nextElementSibling;
            const icon = header.querySelector('.toggle-icon');
            
            if (content.style.display === 'none') {
                content.style.display = 'grid';
                icon.textContent = '▼';
            } else {
                content.style.display = 'none';
                icon.textContent = '▶';
            }
        }

        function submitAsset(event) {
            event.preventDefault();
            
            const formData = new FormData(event.target);
            const assetData = Object.fromEntries(formData.entries());
            
            // Count filled fields
            let filledFields = 0;
            let totalFields = 0;
            
            for (const [key, value] of Object.entries(assetData)) {
                totalFields++;
                if (value && value.trim() !== '') {
                    filledFields++;
                }
            }
            
            // Simulate form submission with comprehensive data
            alert(`✅ Asset submitted successfully!\n\n📊 Form Completion: ${filledFields}/${totalFields} fields filled\n\n🏢 Asset Details:\n• Asset ID: ${assetData.assetId}\n• Building Name: ${assetData.buildingName}\n• Region: ${assetData.region}\n• City: ${assetData.city}\n• Condition: ${assetData.assetCondition}\n• Status: ${assetData.assetStatus}\n\n📍 Location:\n• Latitude: ${assetData.latitude || 'Not set'}\n• Longitude: ${assetData.longitude || 'Not set'}\n\n💰 Financial:\n• Estimated Value: ${assetData.estimatedValue ? 'SAR ' + Number(assetData.estimatedValue).toLocaleString() : 'Not specified'}\n\n🏗️ Construction:\n• Year: ${assetData.constructionYear || 'Not specified'}\n• Status: ${assetData.constructionStatus || 'Not specified'}\n\n📐 Dimensions:\n• Land Area: ${assetData.landArea ? assetData.landArea + ' m²' : 'Not specified'}\n• Built-up Area: ${assetData.builtUpArea ? assetData.builtUpArea + ' m²' : 'Not specified'}\n• Floors: ${assetData.floors || 'Not specified'}\n• Rooms: ${assetData.rooms || 'Not specified'}`);
            
            // Reset form
            event.target.reset();
            document.getElementById('assetId').value = 'AST-005';
            
            // Clear map marker
            if (currentMarker) {
                map.removeLayer(currentMarker);
                currentMarker = null;
            }
            
            // Clear coordinate fields
            document.getElementById('latitude').value = '';
            document.getElementById('longitude').value = '';
        }

        function resetForm() {
            document.getElementById('assetForm').reset();
            document.getElementById('assetId').value = 'AST-004';
            
            // Clear map marker
            if (currentMarker) {
                map.removeLayer(currentMarker);
                currentMarker = null;
            }
            
            // Clear coordinate fields
            document.getElementById('latitude').value = '';
            document.getElementById('longitude').value = '';
        }

        // Asset functions
        function viewAsset(assetId) {
            const asset = sampleAssets[assetId];
            if (!asset) return;
            
            document.getElementById('assetModalTitle').textContent = `Asset Details - ${asset.id}`;
            document.getElementById('assetModalBody').innerHTML = `
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
                    <div><strong>Asset ID:</strong> ${asset.id}</div>
                    <div><strong>Building Name:</strong> ${asset.buildingName}</div>
                    <div><strong>Region:</strong> ${asset.region}</div>
                    <div><strong>City:</strong> ${asset.city}</div>
                    <div><strong>District:</strong> ${asset.district || 'N/A'}</div>
                    <div><strong>Neighborhood:</strong> ${asset.neighborhood || 'N/A'}</div>
                    <div><strong>Condition:</strong> ${asset.condition}</div>
                    <div><strong>Status:</strong> ${asset.status}</div>
                    <div><strong>Land Area:</strong> ${asset.landArea ? asset.landArea + ' m²' : 'N/A'}</div>
                    <div><strong>Built-up Area:</strong> ${asset.builtUpArea ? asset.builtUpArea + ' m²' : 'N/A'}</div>
                    <div><strong>Usable Area:</strong> ${asset.usableArea ? asset.usableArea + ' m²' : 'N/A'}</div>
                    <div><strong>Floors:</strong> ${asset.floors || 'N/A'}</div>
                    <div><strong>Rooms:</strong> ${asset.rooms || 'N/A'}</div>
                    <div><strong>Parking Spaces:</strong> ${asset.parkingSpaces || 'N/A'}</div>
                    <div><strong>Construction Year:</strong> ${asset.constructionYear || 'N/A'}</div>
                    <div><strong>Renovation Year:</strong> ${asset.renovationYear || 'N/A'}</div>
                    <div><strong>Ownership Type:</strong> ${asset.ownershipType || 'N/A'}</div>
                    <div><strong>Owner Name:</strong> ${asset.ownerName || 'N/A'}</div>
                    <div><strong>Estimated Value:</strong> ${asset.estimatedValue ? 'SAR ' + Number(asset.estimatedValue).toLocaleString() : 'N/A'}</div>
                    <div><strong>Coordinates:</strong> ${asset.latitude}, ${asset.longitude}</div>
                    <div><strong>Created:</strong> ${asset.created}</div>
                </div>
                <div style="margin-top: 20px; text-align: right;">
                    <button class="btn-secondary" onclick="closeModal('assetModal')">Close</button>
                    <button class="btn-primary" style="margin-left: 10px;" onclick="editAsset('${asset.id}')">Edit Asset</button>
                </div>
            `;
            document.getElementById('assetModal').style.display = 'block';
        }

        function editAsset(assetId) {
            const asset = sampleAssets[assetId];
            if (!asset) return;
            
            document.getElementById('assetModalTitle').textContent = `Edit Asset - ${asset.id}`;
            document.getElementById('assetModalBody').innerHTML = `
                <form id="editAssetForm">
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; max-height: 400px; overflow-y: auto;">
                        <div class="field-group">
                            <label>Building Name:</label>
                            <input type="text" value="${asset.buildingName}" name="buildingName">
                        </div>
                        <div class="field-group">
                            <label>Region:</label>
                            <select name="region">
                                <option value="Riyadh" ${asset.region === 'Riyadh' ? 'selected' : ''}>Riyadh</option>
                                <option value="Makkah" ${asset.region === 'Makkah' ? 'selected' : ''}>Makkah</option>
                                <option value="Eastern Province" ${asset.region === 'Eastern Province' ? 'selected' : ''}>Eastern Province</option>
                                <option value="Madinah" ${asset.region === 'Madinah' ? 'selected' : ''}>Madinah</option>
                                <option value="Asir" ${asset.region === 'Asir' ? 'selected' : ''}>Asir</option>
                            </select>
                        </div>
                        <div class="field-group">
                            <label>City:</label>
                            <input type="text" value="${asset.city}" name="city">
                        </div>
                        <div class="field-group">
                            <label>District:</label>
                            <input type="text" value="${asset.district || ''}" name="district">
                        </div>
                        <div class="field-group">
                            <label>Neighborhood:</label>
                            <input type="text" value="${asset.neighborhood || ''}" name="neighborhood">
                        </div>
                        <div class="field-group">
                            <label>Condition:</label>
                            <select name="condition">
                                <option value="Excellent" ${asset.condition === 'Excellent' ? 'selected' : ''}>Excellent</option>
                                <option value="Good" ${asset.condition === 'Good' ? 'selected' : ''}>Good</option>
                                <option value="Fair" ${asset.condition === 'Fair' ? 'selected' : ''}>Fair</option>
                                <option value="Poor" ${asset.condition === 'Poor' ? 'selected' : ''}>Poor</option>
                            </select>
                        </div>
                        <div class="field-group">
                            <label>Status:</label>
                            <select name="status">
                                <option value="Active" ${asset.status === 'Active' ? 'selected' : ''}>Active</option>
                                <option value="Under Review" ${asset.status === 'Under Review' ? 'selected' : ''}>Under Review</option>
                                <option value="Inactive" ${asset.status === 'Inactive' ? 'selected' : ''}>Inactive</option>
                                <option value="Planned" ${asset.status === 'Planned' ? 'selected' : ''}>Planned</option>
                            </select>
                        </div>
                        <div class="field-group">
                            <label>Land Area (m²):</label>
                            <input type="number" value="${asset.landArea || ''}" name="landArea" step="0.01">
                        </div>
                        <div class="field-group">
                            <label>Built-up Area (m²):</label>
                            <input type="number" value="${asset.builtUpArea || ''}" name="builtUpArea" step="0.01">
                        </div>
                        <div class="field-group">
                            <label>Usable Area (m²):</label>
                            <input type="number" value="${asset.usableArea || ''}" name="usableArea" step="0.01">
                        </div>
                        <div class="field-group">
                            <label>Floors:</label>
                            <input type="number" value="${asset.floors || ''}" name="floors">
                        </div>
                        <div class="field-group">
                            <label>Rooms:</label>
                            <input type="number" value="${asset.rooms || ''}" name="rooms">
                        </div>
                        <div class="field-group">
                            <label>Parking Spaces:</label>
                            <input type="number" value="${asset.parkingSpaces || ''}" name="parkingSpaces">
                        </div>
                        <div class="field-group">
                            <label>Construction Year:</label>
                            <input type="number" value="${asset.constructionYear || ''}" name="constructionYear" min="1900" max="2030">
                        </div>
                        <div class="field-group">
                            <label>Renovation Year:</label>
                            <input type="number" value="${asset.renovationYear || ''}" name="renovationYear" min="1900" max="2030">
                        </div>
                        <div class="field-group">
                            <label>Ownership Type:</label>
                            <select name="ownershipType">
                                <option value="Government" ${asset.ownershipType === 'Government' ? 'selected' : ''}>Government</option>
                                <option value="Private" ${asset.ownershipType === 'Private' ? 'selected' : ''}>Private</option>
                                <option value="Mixed" ${asset.ownershipType === 'Mixed' ? 'selected' : ''}>Mixed</option>
                                <option value="Leased" ${asset.ownershipType === 'Leased' ? 'selected' : ''}>Leased</option>
                            </select>
                        </div>
                        <div class="field-group">
                            <label>Owner Name:</label>
                            <input type="text" value="${asset.ownerName || ''}" name="ownerName">
                        </div>
                        <div class="field-group">
                            <label>Estimated Value (SAR):</label>
                            <input type="number" value="${asset.estimatedValue || ''}" name="estimatedValue" step="0.01">
                        </div>
                    </div>
                    <div style="margin-top: 20px; text-align: right;">
                        <button type="button" class="btn-secondary" onclick="closeModal('assetModal')">Cancel</button>
                        <button type="submit" class="btn-primary" style="margin-left: 10px;">Save Changes</button>
                    </div>
                </form>
            `;
            
            document.getElementById('editAssetForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const formData = new FormData(e.target);
                const updatedData = Object.fromEntries(formData.entries());
                
                // Update the asset data
                Object.assign(sampleAssets[assetId], updatedData);
                
                alert('✅ Asset changes saved successfully!\n\nUpdated fields:\n' + 
                      Object.entries(updatedData)
                        .filter(([key, value]) => value && value.trim() !== '')
                        .map(([key, value]) => `• ${key}: ${value}`)
                        .join('\n'));
                closeModal('assetModal');
                
                // Refresh the assets table if visible
                if (document.getElementById('assets').classList.contains('active')) {
                    loadAssets();
                }
            });
            
            document.getElementById('assetModal').style.display = 'block';
        }

        // User functions
        function loadUsers() {
            console.log('Users loaded');
        }

        function viewUser(userId) {
            const user = sampleUsers[userId];
            if (!user) return;
            
            document.getElementById('userModalTitle').textContent = `User Details - ID ${user.id}`;
            document.getElementById('userModalBody').innerHTML = `
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
                    <div><strong>User ID:</strong> ${user.id}</div>
                    <div><strong>Username:</strong> ${user.username}</div>
                    <div><strong>Name:</strong> ${user.name}</div>
                    <div><strong>Email:</strong> ${user.email}</div>
                    <div><strong>Role:</strong> ${user.role}</div>
                    <div><strong>Department:</strong> ${user.department}</div>
                    <div><strong>Region:</strong> ${user.region}</div>
                    <div><strong>Status:</strong> ${user.status}</div>
                    <div><strong>Last Login:</strong> ${user.lastLogin}</div>
                </div>
                <div style="margin-top: 20px; text-align: right;">
                    <button class="btn-secondary" onclick="closeModal('userModal')">Close</button>
                    <button class="btn-primary" style="margin-left: 10px;" onclick="editUser('${user.id}')">Edit User</button>
                </div>
            `;
            document.getElementById('userModal').style.display = 'block';
        }

        function editUser(userId) {
            const user = sampleUsers[userId];
            if (!user) return;
            
            document.getElementById('userModalTitle').textContent = `Edit User - ${user.username}`;
            document.getElementById('userModalBody').innerHTML = `
                <form id="editUserForm">
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
                        <div class="field-group">
                            <label>Username:</label>
                            <input type="text" value="${user.username}" name="username">
                        </div>
                        <div class="field-group">
                            <label>Full Name:</label>
                            <input type="text" value="${user.name}" name="name">
                        </div>
                        <div class="field-group">
                            <label>Email:</label>
                            <input type="email" value="${user.email}" name="email">
                        </div>
                        <div class="field-group">
                            <label>Role:</label>
                            <select name="role">
                                <option value="User" ${user.role === 'User' ? 'selected' : ''}>User</option>
                                <option value="Regional Manager" ${user.role === 'Regional Manager' ? 'selected' : ''}>Regional Manager</option>
                                <option value="Investment Analyst" ${user.role === 'Investment Analyst' ? 'selected' : ''}>Investment Analyst</option>
                                <option value="Central Admin" ${user.role === 'Central Admin' ? 'selected' : ''}>Central Admin</option>
                            </select>
                        </div>
                        <div class="field-group">
                            <label>Department:</label>
                            <select name="department">
                                <option value="Asset Management" ${user.department === 'Asset Management' ? 'selected' : ''}>Asset Management</option>
                                <option value="Financial Planning" ${user.department === 'Financial Planning' ? 'selected' : ''}>Financial Planning</option>
                                <option value="IT Administration" ${user.department === 'IT Administration' ? 'selected' : ''}>IT Administration</option>
                                <option value="Regional Operations" ${user.department === 'Regional Operations' ? 'selected' : ''}>Regional Operations</option>
                            </select>
                        </div>
                        <div class="field-group">
                            <label>Region:</label>
                            <select name="region">
                                <option value="All Regions" ${user.region === 'All Regions' ? 'selected' : ''}>All Regions</option>
                                <option value="Riyadh" ${user.region === 'Riyadh' ? 'selected' : ''}>Riyadh</option>
                                <option value="Makkah" ${user.region === 'Makkah' ? 'selected' : ''}>Makkah</option>
                                <option value="Eastern Province" ${user.region === 'Eastern Province' ? 'selected' : ''}>Eastern Province</option>
                                <option value="Madinah" ${user.region === 'Madinah' ? 'selected' : ''}>Madinah</option>
                                <option value="Asir" ${user.region === 'Asir' ? 'selected' : ''}>Asir</option>
                            </select>
                        </div>
                    </div>
                    <div style="margin-top: 20px; text-align: right;">
                        <button type="button" class="btn-secondary" onclick="closeModal('userModal')">Cancel</button>
                        <button type="submit" class="btn-primary" style="margin-left: 10px;">Save Changes</button>
                    </div>
                </form>
            `;
            
            document.getElementById('editUserForm').addEventListener('submit', function(e) {
                e.preventDefault();
                alert('✅ User changes saved successfully!');
                closeModal('userModal');
                loadUsers();
            });
            
            document.getElementById('userModal').style.display = 'block';
        }

        function showCreateUserModal() {
            document.getElementById('userModalTitle').textContent = 'Add New User';
            document.getElementById('userModalBody').innerHTML = `
                <form id="createUserForm">
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
                        <div class="field-group">
                            <label>Username *:</label>
                            <input type="text" name="username" required>
                        </div>
                        <div class="field-group">
                            <label>Full Name *:</label>
                            <input type="text" name="name" required>
                        </div>
                        <div class="field-group">
                            <label>Email *:</label>
                            <input type="email" name="email" required>
                        </div>
                        <div class="field-group">
                            <label>Role *:</label>
                            <select name="role" required>
                                <option value="">Select Role</option>
                                <option value="User">User</option>
                                <option value="Regional Manager">Regional Manager</option>
                                <option value="Investment Analyst">Investment Analyst</option>
                                <option value="Central Admin">Central Admin</option>
                            </select>
                        </div>
                        <div class="field-group">
                            <label>Department *:</label>
                            <select name="department" required>
                                <option value="">Select Department</option>
                                <option value="Asset Management">Asset Management</option>
                                <option value="Financial Planning">Financial Planning</option>
                                <option value="IT Administration">IT Administration</option>
                                <option value="Regional Operations">Regional Operations</option>
                            </select>
                        </div>
                        <div class="field-group">
                            <label>Region *:</label>
                            <select name="region" required>
                                <option value="">Select Region</option>
                                <option value="All Regions">All Regions</option>
                                <option value="Riyadh">Riyadh</option>
                                <option value="Makkah">Makkah</option>
                                <option value="Eastern Province">Eastern Province</option>
                                <option value="Madinah">Madinah</option>
                                <option value="Asir">Asir</option>
                            </select>
                        </div>
                    </div>
                    <div style="margin-top: 20px; text-align: right;">
                        <button type="button" class="btn-secondary" onclick="closeModal('userModal')">Cancel</button>
                        <button type="submit" class="btn-primary" style="margin-left: 10px;">Add User</button>
                    </div>
                </form>
            `;
            
            document.getElementById('createUserForm').addEventListener('submit', function(e) {
                e.preventDefault();
                alert('✅ User created successfully!');
                closeModal('userModal');
                loadUsers();
            });
            
            document.getElementById('userModal').style.display = 'block';
        }

        // Workflow functions
        function loadWorkflows() {
            console.log('Workflows loaded');
        }

        function viewWorkflow(workflowId) {
            const workflow = sampleWorkflows[workflowId];
            if (!workflow) return;
            
            document.getElementById('workflowModalTitle').textContent = `Workflow Details - ${workflow.id}`;
            document.getElementById('workflowModalBody').innerHTML = `
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
                    <div><strong>Workflow ID:</strong> ${workflow.id}</div>
                    <div><strong>Title:</strong> ${workflow.title}</div>
                    <div><strong>Status:</strong> ${workflow.status}</div>
                    <div><strong>Priority:</strong> ${workflow.priority}</div>
                    <div><strong>Assigned To:</strong> ${workflow.assignedTo}</div>
                    <div><strong>Due Date:</strong> ${workflow.dueDate}</div>
                    <div><strong>Asset ID:</strong> ${workflow.assetId}</div>
                    <div><strong>Created:</strong> ${workflow.created}</div>
                    <div style="grid-column: 1 / -1;"><strong>Description:</strong><br>${workflow.description}</div>
                </div>
                <div style="margin-top: 20px; text-align: right;">
                    <button class="btn-secondary" onclick="closeModal('workflowModal')">Close</button>
                    <button class="btn-primary" style="margin-left: 10px;" onclick="editWorkflow('${workflow.id}')">Edit Workflow</button>
                </div>
            `;
            document.getElementById('workflowModal').style.display = 'block';
        }

        function editWorkflow(workflowId) {
            const workflow = sampleWorkflows[workflowId];
            if (!workflow) return;
            
            document.getElementById('workflowModalTitle').textContent = `Edit Workflow - ${workflow.id}`;
            document.getElementById('workflowModalBody').innerHTML = `
                <form id="editWorkflowForm">
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
                        <div class="field-group">
                            <label>Title:</label>
                            <input type="text" value="${workflow.title}" name="title">
                        </div>
                        <div class="field-group">
                            <label>Status:</label>
                            <select name="status">
                                <option value="Pending" ${workflow.status === 'Pending' ? 'selected' : ''}>Pending</option>
                                <option value="In Progress" ${workflow.status === 'In Progress' ? 'selected' : ''}>In Progress</option>
                                <option value="Review" ${workflow.status === 'Review' ? 'selected' : ''}>Review</option>
                                <option value="Completed" ${workflow.status === 'Completed' ? 'selected' : ''}>Completed</option>
                            </select>
                        </div>
                        <div class="field-group">
                            <label>Priority:</label>
                            <select name="priority">
                                <option value="Low" ${workflow.priority === 'Low' ? 'selected' : ''}>Low</option>
                                <option value="Medium" ${workflow.priority === 'Medium' ? 'selected' : ''}>Medium</option>
                                <option value="High" ${workflow.priority === 'High' ? 'selected' : ''}>High</option>
                            </select>
                        </div>
                        <div class="field-group">
                            <label>Assigned To:</label>
                            <select name="assignedTo">
                                <option value="Ahmed Al-Rashid" ${workflow.assignedTo === 'Ahmed Al-Rashid' ? 'selected' : ''}>Ahmed Al-Rashid</option>
                                <option value="Fatima Al-Zahra" ${workflow.assignedTo === 'Fatima Al-Zahra' ? 'selected' : ''}>Fatima Al-Zahra</option>
                                <option value="System Administrator" ${workflow.assignedTo === 'System Administrator' ? 'selected' : ''}>System Administrator</option>
                            </select>
                        </div>
                        <div class="field-group">
                            <label>Due Date:</label>
                            <input type="date" value="${workflow.dueDate}" name="dueDate">
                        </div>
                        <div class="field-group">
                            <label>Asset ID:</label>
                            <input type="text" value="${workflow.assetId}" name="assetId">
                        </div>
                        <div class="field-group" style="grid-column: 1 / -1;">
                            <label>Description:</label>
                            <textarea name="description" rows="3">${workflow.description}</textarea>
                        </div>
                    </div>
                    <div style="margin-top: 20px; text-align: right;">
                        <button type="button" class="btn-secondary" onclick="closeModal('workflowModal')">Cancel</button>
                        <button type="submit" class="btn-primary" style="margin-left: 10px;">Save Changes</button>
                    </div>
                </form>
            `;
            
            document.getElementById('editWorkflowForm').addEventListener('submit', function(e) {
                e.preventDefault();
                alert('✅ Workflow changes saved successfully!');
                closeModal('workflowModal');
                loadWorkflows();
            });
            
            document.getElementById('workflowModal').style.display = 'block';
        }

        function showCreateWorkflowModal() {
            document.getElementById('workflowModalTitle').textContent = 'Create New Workflow';
            document.getElementById('workflowModalBody').innerHTML = `
                <form id="createWorkflowForm">
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
                        <div class="field-group">
                            <label>Title *:</label>
                            <input type="text" name="title" required>
                        </div>
                        <div class="field-group">
                            <label>Priority *:</label>
                            <select name="priority" required>
                                <option value="">Select Priority</option>
                                <option value="Low">Low</option>
                                <option value="Medium">Medium</option>
                                <option value="High">High</option>
                            </select>
                        </div>
                        <div class="field-group">
                            <label>Assigned To *:</label>
                            <select name="assignedTo" required>
                                <option value="">Select User</option>
                                <option value="Ahmed Al-Rashid">Ahmed Al-Rashid</option>
                                <option value="Fatima Al-Zahra">Fatima Al-Zahra</option>
                                <option value="System Administrator">System Administrator</option>
                            </select>
                        </div>
                        <div class="field-group">
                            <label>Due Date *:</label>
                            <input type="date" name="dueDate" required>
                        </div>
                        <div class="field-group">
                            <label>Related Asset ID (Optional):</label>
                            <input type="text" name="assetId" placeholder="e.g., AST-001">
                        </div>
                        <div class="field-group" style="grid-column: 1 / -1;">
                            <label>Description:</label>
                            <textarea name="description" rows="3" placeholder="Describe the workflow..."></textarea>
                        </div>
                    </div>
                    <div style="margin-top: 20px; text-align: right;">
                        <button type="button" class="btn-secondary" onclick="closeModal('workflowModal')">Cancel</button>
                        <button type="submit" class="btn-primary" style="margin-left: 10px;">Create Workflow</button>
                    </div>
                </form>
            `;
            
            document.getElementById('createWorkflowForm').addEventListener('submit', function(e) {
                e.preventDefault();
                alert('✅ Workflow created successfully!');
                closeModal('workflowModal');
                loadWorkflows();
            });
            
            document.getElementById('workflowModal').style.display = 'block';
        }

        // Dashboard functions
        function loadDashboardData() {
            console.log('Dashboard data loaded');
        }

        function loadAssets() {
            console.log('Assets data loaded');
        }

        // Report functions
        function generateReport(reportType) {
            const reportTitles = {
                'asset-summary': 'Asset Summary Report',
                'regional-distribution': 'Regional Distribution Report',
                'construction-status': 'Construction Status Report',
                'investment-analysis': 'Investment Analysis Report'
            };
            
            const title = reportTitles[reportType] || 'Report';
            
            alert(`📊 Generating ${title}...\n\n✅ Report Features:\n• Comprehensive data analysis\n• Charts and visualizations\n• Detailed statistics\n• Export to PDF format\n• Real-time data integration\n\n🔄 Processing complete!\nReport will be available for download shortly.`);
        }

        // Modal functions
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // File upload functions
        function setupFileUpload() {
            const fileInputs = document.querySelectorAll('input[type="file"]');
            
            fileInputs.forEach(input => {
                input.addEventListener('change', function(e) {
                    const files = Array.from(e.target.files);
                    if (files.length > 0) {
                        const uploadArea = e.target.parentElement.querySelector('.file-upload-area');
                        
                        let fileList = files.map(file => 
                            `✅ ${file.name} (${(file.size / 1024 / 1024).toFixed(2)} MB)`
                        ).join('<br>');
                        
                        uploadArea.innerHTML = `
                            <div style="text-align: left;">
                                ${fileList}
                            </div>
                            <button type="button" onclick="removeFiles(this)" style="margin-top: 10px; padding: 5px 10px; background: #dc3545; color: white; border: none; border-radius: 3px; cursor: pointer;">Remove All</button>
                        `;
                        
                        // Simulate OCR processing for image/PDF files
                        const processableFiles = files.filter(file => 
                            file.type.startsWith('image/') || file.type === 'application/pdf'
                        );
                        
                        if (processableFiles.length > 0) {
                            setTimeout(() => {
                                alert(`🔍 OCR processing completed for ${processableFiles.length} file(s)\n\n✅ Results:\n• Text extraction successful\n• Data validation completed\n• Relevant fields auto-populated\n• Document analysis finished\n\n📋 ${Math.floor(Math.random() * 50) + 20} fields were automatically filled from the uploaded documents.`);
                            }, 2000);
                        }
                    }
                });
            });
        }

        function removeFiles(button) {
            const uploadArea = button.parentElement;
            const input = uploadArea.parentElement.querySelector('input[type="file"]');
            input.value = '';
            
            // Reset upload area based on the type
            const label = uploadArea.parentElement.querySelector('label').textContent;
            let icon = '📄';
            let fileTypes = 'PDF, DOC, JPG, PNG (Max 10MB)';
            
            if (label.includes('Survey')) {
                icon = '📊';
            } else if (label.includes('Investment')) {
                icon = '💰';
                fileTypes = 'PDF, DOC, XLS, XLSX (Max 10MB)';
            } else if (label.includes('Financial')) {
                icon = '💳';
                fileTypes = 'PDF, DOC, XLS, XLSX (Max 10MB)';
            } else if (label.includes('Engineering')) {
                icon = '🏗️';
            } else if (label.includes('Other')) {
                icon = '📋';
            }
            
            uploadArea.innerHTML = `
                <p>${icon} Click to upload or drag and drop</p>
                <p style="font-size: 12px; color: #666;">${fileTypes}</p>
            `;
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Login form
            document.getElementById('loginForm').addEventListener('submit', login);
            
            // Asset form
            document.getElementById('assetForm').addEventListener('submit', submitAsset);
            
            // Setup file uploads
            setupFileUpload();
            
            // Close modals when clicking outside
            window.addEventListener('click', function(event) {
                const modals = document.querySelectorAll('.modal');
                modals.forEach(modal => {
                    if (event.target === modal) {
                        modal.style.display = 'none';
                    }
                });
            });
        });
    </script>
</body>
</html>

